<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <title>MIV Approval</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-body-white border-bottom border-1 border-secondary border-opacity-25 rounded-bottom shadow">
        <div class="container-fluid">
            <img src="logo.png" alt="">
            <a class="navbar-brand text-success inter" href="dashboard.html">RRMMS</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav justify-content-center align-items-center fs-5 flex-grow-1 pe-3">
                    <li class="nav-item">
                        <a class="nav-link text-dark" aria-current="page" href="dashboard.html">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="screen5.html">Repair Request</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="screen6.html">User Approval</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active text-success fw-bold" href="screen7.html">MIV Request</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link  text-dark" aria-current="page" href="Userscreen.html">User Management</a>
                      </li>
                </ul>
                <div>
                    <span id="username">Ahmed Hasan</span>
                    <a class="text-dark" href="login.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="30" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
                            <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </nav>
    <div class="position-relative mt-2">
        <div class="position-absolute top-0 start-50 translate-middle-x"><h3>MIV Request</h3></div>
        <div class="position-absolute top-0 end-0">
            <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search ID">
        </div>
    </div>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th onclick="sortTable(0)"><i class="fas fa-sort"></i> Request ID</th>
                    <th onclick="sortTable(1)"><i class="fas fa-sort"></i> Name</th>
                    <th onclick="sortTable(4)"><i class="fas fa-sort"></i> House No</th>
                    <th onclick="sortTable(3)"><i class="fas fa-sort"></i> Colony</th>
                    <th onclick="sortTable(5)"><i class="fas fa-sort"></i> Nature of Request</th>
                    <th onclick="sortTable(2)"><i class="fas fa-sort"></i> Created Date</th>
                    <th onclick="sortTable(6)"><i class="fas fa-sort"></i> Status</th>    
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Rows will be added here by JavaScript -->
            </tbody>
        </table>
        <div id="pagination" class="d-flex justify-content-between align-items-center">
            <span id="pageInfo" class="mx-1"></span>
            <div class="">
                <button class="btn btn-custom equal-btn" onclick="prevPage()">Previous</button>
                <button class="btn btn-custom equal-btn" onclick="nextPage()">Next</button>
            </div>
        </div>

    
        <script>
            let currentPage = 1;
            const rowsPerPage = 10;
            let data = [];
            let sortOrder = [];
    
            function displayTable(data, table, rowsPerPage, page) {
                table.innerHTML = "";
                page--;
    
                let start = rowsPerPage * page;
                let end = start + rowsPerPage;
                let paginatedItems = data.slice(start, end);
    
                for (let i = 0; i < paginatedItems.length; i++) {
                    let item = paginatedItems[i];
                    let row = document.createElement('tr');
                    row.innerHTML = `
                        <td><a href="test5.html?Request_ID=${item.Request_ID}">${item.Request_ID}</a></td>
                       
                       <td>${item.Name}</td>
                    <td>${item.House_No}</td>
                    <td>${item.Colony}</td>
                    <td>${item.Nature_of_Request}</td>
                    <td>${item.Created_Date}</td>
                    <td>${item.Status}</td>
                    `;
                    table.appendChild(row);
                }
    
                document.getElementById("pageInfo").innerText = `Page ${currentPage} of ${Math.ceil(data.length / rowsPerPage)}`;
            }
    
            function prevPage() {
                if (currentPage > 1) {
                    currentPage--;
                    displayTable(data, table, rowsPerPage, currentPage);
                }
            }
    
            function nextPage() {
                if (currentPage < Math.ceil(data.length / rowsPerPage)) {
                    currentPage++;
                    displayTable(data, table, rowsPerPage, currentPage);
                }
            }
    
            function sortTable(columnIndex) {
                if (sortOrder[columnIndex] === undefined) {
                    sortOrder[columnIndex] = true; // Default to ascending
                } else {
                    sortOrder[columnIndex] = !sortOrder[columnIndex];
                }
    
                data.sort((a, b) => {
                    let cellA = Object.values(a)[columnIndex].toString().toLowerCase();
                    let cellB = Object.values(b)[columnIndex].toString().toLowerCase();
                    if (sortOrder[columnIndex]) {
                        return cellA.localeCompare(cellB);
                    } else {
                        return cellB.localeCompare(cellA);
                    }
                });
                displayTable(data, table, rowsPerPage, currentPage);
            }
    
            function myFunction() {
                const input = document.getElementById("myInput").value.toUpperCase();
                const filteredData = data.filter(item => item.Request_ID.toString().toUpperCase().includes(input));
                displayTable(filteredData, table, rowsPerPage, 1);
            }
    
            document.addEventListener('DOMContentLoaded', function() {
              fetch('http://localhost:3000/data')
                  .then(response => response.json())
                  .then(fetchedData => {
                      data = fetchedData;
                      displayTable(data, document.getElementById('table-body'), rowsPerPage, currentPage);
                  })
                  .catch(error => console.error('Error fetching data:', error));
          });
    
            const table = document.getElementById('table-body');
        </script>


    <style>
        * {
            margin: 0;
            padding: 0;
        }
      
   

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 50px;
            padding: 20px;
        }
        th, td {
            border: 1px solid #19c939;
            text-align: left;
            padding: 8px;
        }
        th {
            background-color:#78f166;

        }
       
        .btn-custom {
            background-color: #78f166;
            border-color: #78f166;
            color: rgb(0, 0, 0);
            width: 100px;
        }
        .btn-custom:hover {
            background-color: #66d957;
            border-color: #66d957;
        }
        .table thead tr th {
            background-color:#78f166;

            cursor: pointer;
        }
        *{
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>
</body>
</html
